<h2 class="titulo-seccion">ğŸ“„ Tipos de Contrato</h2>

<div class="mensaje-info" *ngIf="cargandoTipos">
  ğŸ”„ Cargando tipos de contrato...
</div>
<div class="mensaje-vacio" *ngIf="!cargandoTipos && tiposContrato.length === 0 && !errorTipos">
  âš ï¸ No hay tipos de contrato registrados.
</div>
<div class="mensaje-error" *ngIf="errorTipos">
  âŒ OcurriÃ³ un error al cargar los tipos de contrato.
</div>

<div class="lista grid-contratos">
  <div class="contrato-card" *ngFor="let tipo of tiposContrato">
    <div *ngIf="tipoEditando?.id !== tipo.id">
      <h3>{{ tipo.nombre }}</h3>
      <p class="regla-aplicada">ğŸ”— Regla: {{ tipo.reglas_nombre || 'No asignada' }}</p>
      <div class="acciones">
        <button (click)="editarTipo(tipo)">âœï¸ Editar</button>
        <button (click)="eliminarTipoContrato(tipo.id)">ğŸ—‘ Eliminar</button>
        <button (click)="abrirModalReglas(tipo)">âš™ï¸ Editar reglas</button>
      </div>
    </div>

    <div *ngIf="tipoEditando?.id === tipo.id" class="edicion-contrato">
      <input [(ngModel)]="tipoEditando.nombre" placeholder="Nuevo nombre" />
      <button (click)="guardarEdicionTipo()">ğŸ’¾ Guardar</button>
      <button (click)="cancelarEdicionTipo()">âŒ Cancelar</button>
    </div>
  </div>
</div>
<!-- ğŸªŸ Ventana emergente para editar reglas -->
<div class="modal-reglas" *ngIf="tipoParaEditarReglas" (click)="cerrarModalReglas()">
  <div class="modal-contenido" (click)="$event.stopPropagation()">
    <h3>Editar reglas para: {{ tipoParaEditarReglas.nombre }}</h3>

    <div class="checkboxes">
      <label *ngFor="let campo of [
        'requiere_cotizaciones',
        'controla_asistencia',
        'requiere_liquidacion',
        'genera_vacaciones',
        'afecta_antiguedad',
        'requiere_firma_digital',
        'aplica_seguro_invalidez'
      ]">
        <input type="checkbox" [(ngModel)]="tipoParaEditarReglas[campo]" />
        {{ formatearTexto(campo) }}
      </label>
    </div>

    <div class="acciones">
      <button (click)="guardarReglasEditadas()">ğŸ’¾ Guardar</button>
      <button (click)="cerrarModalReglas()">âŒ Cancelar</button>
    </div>
  </div>
</div>